<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/"
       xmlns="http://www.w3.org/1999/html">

<head th:fragment="header">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title th:text="${title}" ></title>

    <!-- Custom fonts for this template-->
    <link th:href="@{/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet" type="text/css">
    <link
            href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
            rel="stylesheet">

    <!-- Custom styles for this template-->
    <link th:href="@{/css/sb-admin-2.min.css}" rel="stylesheet" type="text/css">
    <link th:href="@{/css/export.css}" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/he/1.2.0/he.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/vfs_fonts.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>



</head>


<body id="page-top">
<!-- Page Wrapper -->
<div id="wrapper">
    <!-- Sidebar -->
    <ul th:replace="~{fragment2 :: sidebar}">
    </ul>
    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <!-- Topbar -->
            <nav th:replace="~{fragment2 :: topbar}"></nav>
            <!-- End of Topbar -->



            <!-- Begin Page Content -->




            <main class="main-wrap">
<!--                <div th:replace="~{fragment2::main-nav}">-->

                </div>

        </main>
                <section class="content-main">
                    <div class="content-header">
                        <div>
                            <h2 class="content-title card-title">Reviews</h2>
                        </div>
<!--                        <div>-->
<!--                            <a href="#" class="btn btn-light rounded font-md">Export</a>-->
<!--                            <a href="#" class="btn btn-light rounded  font-md">Import</a>-->
<!--                            <a th:href="@{/addProduct}" class="btn btn-primary btn-sm rounded">Create new</a>-->
<!--                        </div>-->
                    </div>
                    <div class="card mb-4">
                        <header class="card-header">
                            <div class="row gx-3">
                                <div class="col-lg-4 col-md-6 me-auto">
                                    <input type="text" placeholder="Search..." class="form-control" />
                                </div>
                                <div class="col-lg-2 col-md-3 col-6">
                                    <select class="form-select">
                                        <option>Status</option>
                                        <option>Active</option>
                                        <option>Disabled</option>
                                        <option>Show all</option>
                                    </select>
                                </div>
                                <div class="col-lg-2 col-md-3 col-6">
                                    <select class="form-select">
                                        <option>Show 20</option>
                                        <option>Show 30</option>
                                        <option>Show 40</option>
                                    </select>
                                </div>
                            </div>
                        </header>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                    <tr>


                                        <th>Image</th>
                                        <th>Name</th>
                                        <th>Rating</th>

                                        <th class="text-end">Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="products:${product}">


                                        <td> <img th:if="${not #lists.isEmpty(products.images[0].getName())}"
                                                  th:src="@{|/img/image-product/${products.images[0].getName()}|}"
                                                  style="width: 80px; height: 80px;"></td>
                                        <td><b th:text="${products.name}"></b></td>

                                        <td>
                                            <ul class="rating-stars">
                                                <li style="width: 60%;" class="stars-active">
                                                    <img th:src="@{|/assets/imgs/icons/stars-active.svg}" alt="stars" />
                                                </li>
                                                <li>
                                                    <img th:src="@{|/assets/imgs/icons/starts-disable.svg}" alt="stars" />
                                                </li>
                                            </ul>
                                        </td>

                                        <td class="text-end">
                                            <a th:href="@{/showProductReview(productId=${products.id})}" class="btn btn-md rounded font-sm">Show Review</a>
                                            <!--
                                            <div class="dropdown">
                                                <a href="#" data-bs-toggle="dropdown" class="btn btn-light rounded btn-sm font-sm"> <i class="material-icons md-more_horiz"></i> </a>
                                                <div class="dropdown-menu">
                                                    <a class="dropdown-item" href="#">View detail</a>
                                                    <a class="dropdown-item" href="#">Edit info</a>
                                                    <a class="dropdown-item text-danger" href="#">Delete</a>
                                                </div>
                                            </div> --> <!-- dropdown //end -->
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="pagination-area mt-30 mb-50">
<!--                            <nav aria-label="Page navigation example">-->
<!--                                <ul class="pagination justify-content-start">-->
<!--                                    <li class="page-item " th:if="${currentPage!=0}"><a class="page-link"  th:href="@{'/review/'+ ${currentPage-1}}"><<</a></li>-->
<!--                                    <li class="page-item" th:classappend="${currentPage == i-1 ?'active':''}" th:each="i:${#numbers.sequence(1,totalPage)}">-->
<!--                                        <a class="page-link" th:href="@{'/review/'+${i-1}}"> <span th:text="${i}"></span></a></li>-->
<!--                                    <li class="page-item" th:if="${currentPage+1 !=totalPage}"><a class="page-link" th:href="@{'/review/'+ ${currentPage+1}}">>> </a></li>-->

<!--                                </ul>-->
<!--                            </nav>-->
                        </div>

                        <!-- End of Main Content -->



        <!-- Footer -->
        <footer th:replace="~{fragment2 :: footer}">
        </footer>
        <!-- End of Footer -->

    </div>
    <!-- End of Content Wrapper -->

</section>
            </main>
        </div>
    </div>
</div>
<!-- End of Page Wrapper -->

<!-- Scroll to Top Button-->
<a th:replace="~{fragment2 :: scroll}">
</a>

<!-- Logout Modal-->

<!-- Bootstrap core JavaScript-->
<div th:replace="~{fragment2 :: script}"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js" integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/dataTables.bootstrap4.min.js" integrity="sha512-OQlawZneA7zzfI6B1n1tjUuo3C5mtYuAWpQdg+iI9mkDoo7iFzTqnQHf+K5ThOWNJ9AbXL4+ZDwH7ykySPQc+A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    $(document).ready(function() {
        console.log("table")
        $('#salesReportTable').DataTable(
            {
                order: [
                    [
                        0, 'asc'
                    ]
                ]
            }
        );
    });


</script>

<script>
    function generatePDF() {
        const table = document.getElementById("salesReportTable");
        console.log("table2")
        const content = [];

        // Extract table content
        for (let i = 0; i < table.rows.length; i++) {
            const row = [];
            for (let j = 0; j < table.rows[i].cells.length; j++) {
                row.push({ text: table.rows[i].cells[j].textContent });
            }
            content.push(row);
        }

        // Define the document definition
        const documentDefinition = {
            content: [
                { text: "Sales Report - Myplant", style: "header" },
                {
                    table: {
                        headerRows: 1,
                        widths: ["*", "*", "*", "*", "*", "*"],
                        body: content,
                    },
                },
            ],
            styles: {
                header: {
                    fontSize: 18,
                    bold: true,
                    alignment: "center",
                    margin: [0, 0, 0, 20],
                },
                tableStyle: {
                    fillColor: "#cceeff", // Light blue fill color
                    margin: [0, 10, 0, 0],
                },
            },
        };

        pdfMake.createPdf(documentDefinition).download("SalesReport_Myplant.pdf");
    }

</script>


<script>
    document.getElementById("exportToCSV").addEventListener("click", function () {
        // Select the table
        var table = document.getElementById("salesReportTable");

        // Initialize an empty CSV string
        var csv = "";

        // Iterate through the table rows
        for (var i = 0; i < table.rows.length; i++) {
            var row = table.rows[i];

            // Iterate through the table cells in the row
            for (var j = 0; j < row.cells.length; j++) {
                var cell = row.cells[j];

                // Extract and clean the cell's text content
                var cellText = cell.textContent.trim();

                // Add the cell's content to the CSV string
                csv += cellText;

                // Add a comma as a delimiter, except for the last cell in each row
                if (j < row.cells.length - 1) {
                    csv += ",";
                }
            }

            // Add a newline character to separate rows
            csv += "\n";
        }

        // Create a data URI for the CSV content
        var csvData = "data:text/csv;charset=utf-8," + encodeURIComponent(csv);

        // Create a link to trigger the download
        var csvLink = document.createElement("a");
        csvLink.setAttribute("href", csvData);
        csvLink.setAttribute("download", "SalesReport-Myplant.csv");
        csvLink.click();
    });
</script>



</body>

</html>